mode test

import("std.sys")
import("core.vec")

// Test glob_files
test_glob_files := proc() {
    files := glob_files("src/test/*.til")
    // Should find many .til files
    if files.len().lt(10) {
        panic(loc(), "glob_files should find many .til files in src/test")
    }
    // Check that syscalls.til is in the results (with full path)
    mut found := false
    for f: Str in files {
        if f.eq("src/test/syscalls.til") {
            found = true
        }
    }
    if not(found) {
        panic(loc(), "glob_files did not find src/test/syscalls.til")
    }

    catch (err: IndexOutOfBoundsError) { panic(loc(), err.msg) }
    catch (err: AllocError) { panic(loc(), err.msg) }
}
test_glob_files()

