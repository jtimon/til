mode test

// Test memcmp behavior with string literals in interpreter
// In interpreter, each string literal gets its own allocation,
// so identical literals have different pointers.

test_memcmp_str := proc() {
    mut s1 := "hello"
    mut s2 := "hello"
    mut s3 := "world"

    // In interpreter, s1 and s2 have different pointers even though content is same
    mut result := memcmp(to_ptr(s1), to_ptr(s2), size_of(Str))
    test(loc(), not(result.eq(0)), "memcmp on Str structs compares pointers, not content")

    // Verify content equality works with .eq()
    test(loc(), s1.eq(s2), "s1.eq(s2) should be true for same content")
    test(loc(), not(s1.eq(s3)), "s1.eq(s3) should be false for different content")
}
test_memcmp_str()
